# requires MAnorm2_utils package: https://github.com/tushiqi/MAnorm2_utils

labs=s0,s0,s0,s0,s0,s0.5,s0.5,s0.5,s1,s1,s1,s3,s3,s3,s24,s24,s24,s76,s76,s76

combinedpeaks=./cutandrun_data/MACS_peaks/01_00h-1_comb_peaks_peaks.broadPeak,./cutandrun_data/MACS_peaks/02_00h-2_comb_peaks_peaks.broadPeak,./cutandrun_data/MACS_peaks/02_00h-2_redo_peaks_peaks.broadPeak,./cutandrun_data/MACS_peaks/03_00h-3_comb_peaks_peaks.broadPeak,./cutandrun_data/MACS_peaks/03_00h-3_redo_peaks_peaks.broadPeak,./cutandrun_data/MACS_peaks/04_30m-1_redo_peaks_peaks.broadPeak,./cutandrun_data/MACS_peaks/05_30m-2_redo_peaks_peaks.broadPeak,./cutandrun_data/MACS_peaks/06_30m-3_redo_peaks_peaks.broadPeak,./cutandrun_data/MACS_peaks/04_01h_1_comb_peaks_peaks.broadPeak,./cutandrun_data/MACS_peaks/05_01h-2_comb_peaks_peaks.broadPeak,./cutandrun_data/MACS_peaks/06_01h-3_comb_peaks_peaks.broadPeak,./cutandrun_data/MACS_peaks/07_03h_1_comb_peaks_peaks.broadPeak,./cutandrun_data/MACS_peaks/08_03h-2_comb_peaks_peaks.broadPeak,./cutandrun_data/MACS_peaks/09_03h-3_comb_peaks_peaks.broadPeak,./cutandrun_data/MACS_peaks/10_24h_1_comb_peaks_peaks.broadPeak,./cutandrun_data/MACS_peaks/11_24h-2_comb_peaks_peaks.broadPeak,./cutandrun_data/MACS_peaks/12_24h-3_comb_peaks_peaks.broadPeak,./cutandrun_data/MACS_peaks/13_76h_1_comb_peaks_peaks.broadPeak,./cutandrun_data/MACS_peaks/14_76h-2_comb_peaks_peaks.broadPeak,./cutandrun_data/MACS_peaks/15_76h-3_comb_peaks_peaks.broadPeak

combinedreads=./cutandrun_data/tryp_aligned_bams/bed_files/01_00h_1_CR_comb_sorted.bam.bed,./cutandrun_data/tryp_aligned_bams/bed_files/02_00h_2_CR_comb_sorted.bam.bed,./cutandrun_data/tryp_aligned_bams/bed_files/02_00h_2_redo_sorted.bam.bed,./cutandrun_data/tryp_aligned_bams/bed_files/03_00h_3_CR_comb_sorted.bam.bed,./cutandrun_data/tryp_aligned_bams/bed_files/03_00h_3_redo_sorted.bam.bed,./cutandrun_data/tryp_aligned_bams/bed_files/4_30m-1_redo_sorted.bam.bed,./cutandrun_data/tryp_aligned_bams/bed_files/5_30m-2_redo_sorted.bam.bed,./cutandrun_data/tryp_aligned_bams/bed_files/6_30m-3_redo_sorted.bam.bed,./cutandrun_data/tryp_aligned_bams/bed_files/04_01h_1_CR_comb_sorted.bam.bed,./cutandrun_data/tryp_aligned_bams/bed_files/05_01h_2_CR_comb_sorted.bam.bed,./cutandrun_data/tryp_aligned_bams/bed_files/06_01h_3_CR_comb_sorted.bam.bed,./cutandrun_data/tryp_aligned_bams/bed_files/07_03h_1_CR_comb_sorted.bam.bed,./cutandrun_data/tryp_aligned_bams/bed_files/08_03h_2_CR_comb_sorted.bam.bed,./cutandrun_data/tryp_aligned_bams/bed_files/09_03h_3_CR_comb_sorted.bam.bed,./cutandrun_data/tryp_aligned_bams/bed_files/10_24h_1_CR_comb_sorted.bam.bed,./cutandrun_data/tryp_aligned_bams/bed_files/11_24h_2_CR_comb_sorted.bam.bed,./cutandrun_data/tryp_aligned_bams/bed_files/12_24h_3_CR_comb_sorted.bam.bed,./cutandrun_data/tryp_aligned_bams/bed_files/13_76h_1_CR_comb_sorted.bam.bed,./cutandrun_data/tryp_aligned_bams/bed_files/14_76h_2_CR_comb_sorted.bam.bed,./cutandrun_data/tryp_aligned_bams/bed_files/15_76h_3_CR_comb_sorted.bam.bed

echo "creating bin profile"
profile_bins --peaks=$combinedpeaks --typical-bin-size=1000 --reads=$combinedreads --labs=$labs -n ./cutandrun_data/cutandrun
echo "finished profiling"